function getPageScroll(){var e;return self.pageYOffset?e=self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),arrayPageScroll=new Array("",e)}function getPageSize(){var e,t;window.innerHeight&&window.scrollMaxY?(e=document.body.scrollWidth,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(e=document.body.scrollWidth,t=document.body.scrollHeight):(e=document.body.offsetWidth,t=document.body.offsetHeight);var n,i;return self.innerHeight?(n=self.innerWidth,i=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(n=document.documentElement.clientWidth,i=document.documentElement.clientHeight):document.body&&(n=document.body.clientWidth,i=document.body.clientHeight),pageHeight=i>t?i:t,pageWidth=n>e?n:e,arrayPageSize=new Array(pageWidth,pageHeight,n,i)}function pause(e){for(var t=new Date,n=t.getTime()+e;;)if(t=new Date,t.getTime()>n)return}function getKey(e){keycode=null==e?event.keyCode:e.which,key=String.fromCharCode(keycode).toLowerCase(),"x"==key&&hideLightbox()}function listenKey(){document.onkeypress=getKey}function closeLightbox(){for(var e=0;e<all_lightboxes.length;e++){var t=all_lightboxes[e];document.getElementById("overlay").style.display="none",document.getElementById("lightbox-"+t).style.display="none",document.getElementById("lightboxDetails-"+t).style.display="none"}}function blockLightbox(){for(var e=0;e<all_lightboxes.length;e++){var t=all_lightboxes[e],n=all_lifetimes[e];setCookie(t,1,n)}}function createExitIntent(e,t,n,i,o,l,a,d){function s(t){"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent","exit-intent-popup","open",e]),"function"==typeof ga&&ga("send","event","exit-intent-popup","open",e);var n=document.getElementById("overlay"),a=document.getElementById("lightbox-"+e),d=document.getElementById("lightboxImage-"+e),s=document.getElementById("loadingImage"),c=document.getElementById("lightboxDetails-"+e),r=getPageSize(),g=getPageScroll();if(s&&(s.style.top=g[1]+(r[3]-35-s.height)/2+"px",s.style.left=(r[0]-20-s.width)/2+"px",s.style.display="block"),n.style.height=r[1]+"px",n.style.display="block",1==l)imgPreload=new Image,imgPreload.onload=function(){d.src=t.src,d.style.width=i+"px",d.style.height=o+"px";var e=g[1]+(r[3]-35-imgPreload.height)/2,l=(r[0]-20-imgPreload.width)/2;return a.style.top=0>e?"0px":e+"px",a.style.left=0>l?"0px":l+"px",c.style.width=imgPreload.width+"px",t.getAttribute("title"),-1!=navigator.appVersion.indexOf("MSIE")&&pause(250),s&&(s.style.display="none"),a.style.display="block",r=getPageSize(),n.style.height=r[1]+"px",listenKey(),!1},imgPreload.src=t.src;else if(2==l||0==l){document.getElementById("targetLink-"+e).style.display="none";var m=g[1]+(r[3]-35-o)/2,y=(r[0]-20-i)/2;a.style.top=0>m?"0px":m+"px",a.style.left=0>y?"0px":y+"px",-1!=navigator.appVersion.indexOf("MSIE")&&pause(250),s&&(s.style.display="none"),c.innerHTML=document.getElementById("lightboxContent-"+e).innerHTML,a.style.display="block",c.style.display="block",r=getPageSize(),n.style.height=r[1]+"px",0==l&&(document.getElementById("lightboxframe-"+e).style.width=i+"px",document.getElementById("lightboxframe-"+e).style.height=o+"px"),listenKey()}}function c(){document.getElementById("overlay").style.display="none",document.getElementById("lightbox-"+e).style.display="none",document.getElementById("lightboxDetails-"+e).style.display="none",document.onkeypress=""}function r(){if(document.getElementsByTagName){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=exit_css+"lightbox.css",n.media="screen",t.appendChild(n);var s=document.getElementsByTagName("body").item(0),r=document.createElement("img");r.setAttribute("id","overlay"),r.onclick=function(){return c(),!1},r.style.display="none",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.zIndex="90000",r.style.width="100%",r.src=overlayImage,r.style.opacity="0.9",s.insertBefore(r,s.firstChild);var g=(getPageSize(),getPageScroll(),new Image);g.onload=function(){var e=document.createElement("a");e.setAttribute("href","#"),e.onclick=function(){return c(),!1},r.appendChild(e);var t=document.createElement("img");return t.src=loadingImage,t.setAttribute("id","loadingImage"),t.style.position="absolute",t.style.zIndex="150000",e.appendChild(t),g.onload=function(){},!1},g.src=loadingImage;var m=document.createElement("div");m.setAttribute("id","lightbox-"+e),m.className=m.className+" thelightbox "+e,m.style.display="none",m.style.position="absolute",m.style.zIndex="100000",m.style.width=i+"px",m.style.height=o+"px",s.insertBefore(m,r.nextSibling);var y=document.createElement("div");y.setAttribute("id","lightboxContent-"+e),2==l&&(y.innerHTML=a),0==l&&(y.innerHTML="<iframe id='lightboxframe-"+e+"' src='"+a+"'></iframe>"),y.className=y.className+" lightboxContent c-"+e,y.style.display="none",s.insertBefore(y,m.nextSibling);var u=document.createElement("a");u.setAttribute("id","targetLink-"+e),u.className=u.className+" targetLink",u.setAttribute("href",d),u.setAttribute("title","Click to close"),u.onclick=function(){return c(),1==l&&(document.location.href=d),!1},m.appendChild(u);var h=new Image;h.onload=function(){var e=document.createElement("img");return e.src=closeButton,e.setAttribute("id","closeButton"),e.style.position="absolute",e.style.zIndex="200000",e.style.marginRight="-20px",e.style.marginTop="-5px",e.onclick=function(){return c(),!1},m.appendChild(e),!1},h.src=closeButton;var p=document.createElement("img");p.setAttribute("id","lightboxImage-"+e),p.className=p.className+" lightboxImage",1==l&&(p.src=a),u.appendChild(p);var x=document.createElement("div");x.setAttribute("id","lightboxDetails-"+e),x.className=x.className+" lightboxDetails",x.style.display="none",x.style.zIndex="200000",x.style.width=i+"px",x.style.height=o+"px",x.style.backgroundColor="#fff",m.appendChild(x)}}function g(e){var t=window.onload;window.onload="function"!=typeof window.onload?e:function(){t(),e()}}function m(){return""==getCookie(e)?!1:!0}function y(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}g(r),y(window,"load",function(){1==n?m()||(s(document.getElementById("lightboxImage-"+e)),setCookie(e,1,t)):y(document,"mouseout",function(n){n=n?n:window.event;var i=n.relatedTarget||n.toElement,o=parseInt(n.y);(isNaN(o)||void 0==o)&&(o=parseInt(n.clientY)),(isNaN(o)||void 0==o)&&(o=0),(!i||"HTML"==i.nodeName)&&0>=o&&(m()||(s(document.getElementById("lightboxImage-"+e)),setCookie(e,1,t)))})}),-99==t&&(r(),s(document.getElementById("lightboxImage-"+e)))}function setCookie(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="expires="+i.toGMTString();document.cookie=e+"="+t+";"+o+";path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var o=n[i];if(o.indexOf(t)>=0)return o.substring(t.length,o.length)}return""}function addExitBox(e,t,n,i,o,l,a,d){var s=void 0===e?"":e,c=void 0===t?"":t,r=void 0===n?"lock":n,g=void 0===i?1:i,m=void 0===o?0:o,y=void 0===l?800:l,u=void 0===a?600:a,h=void 0===d?1:d,p=getPageSize();return y>=p[0]||u>=p[1]?!1:(all_lightboxes.push(r),all_lifetimes.push(g),createExitIntent(r,g,m,y,u,h,s,c),!0)}function intentlayer_yes(){document.getElementById("intentlayer").style.display="none",document.getElementById("intentlayer_yes").style.display="block"}function intentlayer_no(){document.getElementById("intentlayer").style.display="none",document.getElementById("intentlayer_no").style.display="block"}var all_lightboxes=[],all_lifetimes=[],loadingImage=exit_images+"loading.gif",closeButton=exit_images+"close.png",overlayImage=exit_images+"overlay.png";addExitBox(exit_content,exit_link,exit_name,exit_lifetime,exit_isOpen,exit_width,exit_height,exit_type);